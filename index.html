<!DOCTYPE html>
<html>

<head>
    <title>String Expression Builder</title>
    <script src="./expression.js"></script>
    <script src="./expressionEvaluation.js"></script>
    <script src="./stringReader.js"></script>
    <script src="./parser.js"></script>
    <link rel="stylesheet" type="text/css" href="./style.css">
</head>

<body>
    <h1>String Expression Builder</h1>
    This tool helps writing string expressions in a similiar way to how C macros work.<br>
    While it can have many uses, this tool was written as a way to write complex <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-functions">template functions</a> used in Azure Resource Manager and Azure Policy.<br>

    <h2>Usage:</h2>
    <ul>
        <li>Define expressions using the #def command (<i>#def HI Hello</i>)</li>
        <li>Expressions can refer to previously defined expressions (<i>#def HI_WORLD HI World</i>)</li>
        <li>
            The last command must be an #eval command that will evaluate the final expression:<br>
            <ul>
                <li>#eval can contain any free text.</li>
                <li>#eval can refer to any of the previously defined expressions.</li>
            </ul>
        </li>
      </ul>
    <textarea id="input" rows="20" cols="150" spellcheck="false"></textarea>
    <script>
        var urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('expression')) {
            document.getElementById('input').value = urlParams.get('expression');
        } else {
            document.getElementById('input').value = "#def HI Hello\n#def HI_WORLD HI World\n\n#eval HI_WORLD!!"   
        }
    </script>
    </br>
    <input type="button" onclick="document.getElementById('output').innerText = evaluateExpression(document.getElementById('input').value)" value="Evaluate">
    <input type="button" onclick="document.getElementById('output').innerText = document.URL + '?expression=' + encodeURIComponent(document.getElementById('input').value)" value="Create Link">
    <h3>Output:</h3>
    <pre id="output" style="min-height:5em;border-style:solid;overflow-x:auto;"></pre>
</body>

</html>